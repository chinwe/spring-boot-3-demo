# Log Desensitization Configuration
# 日志脱敏配置文件

# 全局开关
enabled: true

# 默认掩码字符
defaultMaskChar: '*'

# 脱敏规则配置
rules:
  # 邮箱脱敏规则
  # 示例: test@example.com -> t***@example.com
  - type: EMAIL
    enabled: true
    pattern: "\\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\\.[A-Z|a-z]{2,}\\b"
    keepPrefix: 1
    keepSuffix: 0
    maskChar: '*'
    description: "Email address desensitization"

  # 手机号脱敏规则
  # 示例: 13812345678 -> 138****5678
  - type: PHONE
    enabled: true
    pattern: "\\b1[3-9]\\d{9}\\b"
    keepPrefix: 3
    keepSuffix: 4
    maskChar: '*'
    description: "Phone number desensitization"

  # 身份证号脱敏规则
  # 示例: 110101199001011234 -> 110101********1234
  - type: ID_CARD
    enabled: true
    pattern: "\\b[1-9]\\d{5}(18|19|20)\\d{2}(0[1-9]|1[0-2])(0[1-9]|[12]\\d|3[01])\\d{3}[\\dXx]\\b"
    keepPrefix: 6
    keepSuffix: 4
    maskChar: '*'
    description: "ID card number desensitization"

  # 银行卡号脱敏规则
  # 示例: 6222021234567890123 -> 6222***********0123
  - type: BANK_CARD
    enabled: true
    pattern: "\\b\\d{16,19}\\b"
    keepPrefix: 4
    keepSuffix: 4
    maskChar: '*'
    description: "Bank card number desensitization"

  # 密码脱敏规则（基于键值对字段名）
  # 示例: password=admin123 -> password=******
  - type: PASSWORD
    enabled: true
    keyNames:
      - password
      - pwd
      - passwd
      - token
      - apiKey
      - secret
      - accessToken
      - refreshToken
      - authorization
    maskChar: '*'
    description: "Password and token desensitization"

  # 地址脱敏规则
  # 示例: 北京市朝阳区建国路88号 -> 北京市朝阳区********
  - type: ADDRESS
    enabled: true
    pattern: "[\\u4e00-\\u9fa5]{2,}(省|市|区|县|镇|街道|路|巷|号|室)[\\u4e00-\\u9fa5]{2,}"
    keepPrefix: 6
    keepSuffix: 0
    maskChar: '*'
    description: "Address desensitization"

# 键值对脱敏配置
keyValue:
  enabled: true
  # 支持的键值对分隔符
  separators:
    - "="
    - ":"
    - "=>"
  # 敏感字段名列表
  sensitiveKeys:
    - password
    - pwd
    - passwd
    - token
    - apiKey
    - secret
    - accessToken
    - refreshToken
    - authorization
    - sessionId
    - cookie
    - credentials

# 性能配置
performance:
  # 是否启用正则预编译缓存
  cachePatterns: true
  # 最大缓存数量
  maxCacheSize: 100
